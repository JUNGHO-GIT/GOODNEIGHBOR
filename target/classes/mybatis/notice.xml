<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="notice">

  <!-- 공지사항 등록 -->
	<insert id="insertNotice" parameterType="noticeDTO">
    insert into notice(notice_number,notice_writer,notice_title,notice_content,notice_regdate,notice_fix)
    values(0,#{notice_writer},#{notice_title},#{notice_content},NOW(),0)
	</insert>

  <!-- 공지사항 번호 얻기 -->
	<select id="countNotice" resultType="int">
    select count(*)
    from notice
	</select>

  <!-- 공지사항 검색 번호 얻기 -->
	<select id="searchCount" parameterType="java.util.Map" resultType="int">
    select count(*) from notice
    where ${columnParam} LIKE '%${keyWord}%'
	</select>

  <!-- 공지사항 리스트 -->
	<select id="selectNotice" resultType="noticeDTO">
    select * from notice
    where notice_fix=0
    order by notice_number desc
    limit #{start},#{count}
	</select>

  <!-- 공지사항 검색 리스트 -->
	<select id="searchNotice" parameterType="java.util.Map" resultType="noticeDTO">
    select * from notice
    where notice_fix=0 and ${columnParam} LIKE '%${keyWord}%'
    order by notice_number desc
    limit #{start}, #{count}
	</select>

  <!-- 공지사항 조회수 증가 -->
	<update id="readCnt" parameterType="int">
    update notice set
    notice_readcount=notice_readcount+1
    where notice_number=#{notice_number}
	</update>

  <!-- 공지사항 상세보기 -->
	<select id="oneNotice" parameterType="int" resultType="noticeDTO">
    select * from
    notice where notice_number=#{notice_number}
	</select>

  <!-- 공지사항 수정 -->
	<update id="editNotice" parameterType="noticeDTO">
    update notice set
    notice_title=#{notice_title},notice_content=#{notice_content},
    notice_fix=0
    where notice_number=#{notice_number}
	</update>

  <!-- 공지사항 삭제 -->
	<delete id="deleteNotice" parameterType="int">
    delete from notice
    where notice_number=#{notice_number}
	</delete>

  <!-- 고정 공지사항 등록 -->
	<insert id="fixNotice" parameterType="noticeDTO">
    insert into notice(notice_number,notice_writer,notice_title,notice_content,notice_regdate,notice_fix)
    values(0,#{notice_writer},#{notice_title},#{notice_content},NOW(),1)
	</insert>

  <!-- 고정 공지사항 리스트 -->
	<select id="selectFix" resultType="noticeDTO">
    select * from notice
    where notice_fix=1 order by notice_regdate desc
    limit 0,3
	</select>

  <!-- 고정 공지사항 상세보기 -->
	<update id="updateFix" parameterType="noticeDTO">
    update notice set
    notice_title=#{notice_title},notice_content=#{notice_content},
    notice_fix=1 where notice_number=#{notice_number}
	</update>

</mapper>