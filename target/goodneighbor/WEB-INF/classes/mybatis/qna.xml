<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="qna">

  <!-- 글쓰기 -->
	<insert id="insertQna" parameterType="qnaDTO">
    insert into qna(qna_number,qna_writer,qna_pw,qna_title,qna_content,qna_regdate,qna_ref,qna_step,qna_level)
    values(0,#{qna_writer},#{qna_pw},#{qna_title},#{qna_content},NOW(),#{qna_ref},#{qna_step},#{qna_level})
	</insert>

  <!-- 답변글쓰기 -->
	<select id="qnaMax" resultType="int">
    select max(qna_number)
    from qna
	</select>

  <!-- 답변글쓰기 -->
	<update id="Step" parameterType="qnaDTO">
    update qna
    set qna_step=qna_step+1
    where qna_ref=#{qna_ref} and qna_step>#{qna_step}
	</update>

  <!-- 글 갯수 얻기 -->
	<select id="countQna" resultType="int">
    select count(*)
    from qna
	</select>

  <!-- 리스트 -->
	<select id="listQna" parameterType="java.util.Map" resultType="qnaDTO">
    select * from qna
    order by qna_ref desc, qna_step asc
    limit #{start},#{count}
	</select>

  <!-- 조회수 증가 -->
	<update id="cntQna" parameterType="int">
    update qna
    set qna_readcount=qna_readcount+1
    where qna_number=#{qna_number}
	</update>

  <!-- 글 상세보기 -->
	<select id="oneSelect" parameterType="int" resultType="qnaDTO">
    select * from qna
    where qna_number=#{qna_number}
	</select>

  <!-- 글 수정 -->
	<update id="updateQna" parameterType="qnaDTO">
    update qna set
    qna_writer=#{qna_writer},qna_title=#{qna_title},qna_content=#{qna_content}
    where qna_number=#{qna_number} and qna_pw=#{qna_pw}
	</update>

  <!-- 글 삭제 -->
	<delete id="deleteQna" parameterType="int">
    delete from qna
    where qna_number=#{qna_number}
	</delete>

</mapper>
